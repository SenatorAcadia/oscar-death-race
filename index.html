<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oscar Death Race 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold-light: #F3E5AB;
            --gold-mid: #D4AF37;
            --gold-dark: #8A6E2F;
            --will-color: #4CAF50;
            --should-color: #2196F3;
            --bg-black: #050505;
            --card-bg: #121212;
            --text-white: #f0f0f0;
        }

        body {
            background-color: var(--bg-black);
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
            color: var(--text-white);
            font-family: 'Roboto', sans-serif;
            margin: 0; padding: 0; min-height: 100vh;
        }

        #infoModal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.9);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: #1a1a1a;
            margin: 10% auto;
            padding: 30px;
            border: 2px solid var(--gold-mid);
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 0 30px var(--gold-dark);
        }

        .modal-btn {
            background: var(--gold-mid);
            color: black;
            border: none;
            padding: 12px 25px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            text-transform: uppercase;
            border-radius: 5px;
        }

        .header-container {
            width: 100%;
            border-bottom: 5px solid var(--gold-mid);
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.4);
            background: #000;
        }
        
        .header-img { width: 100%; height: auto; display: block; max-width: 1200px; margin: 0 auto; }

        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        .user-section {
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid var(--gold-dark);
            margin-bottom: 40px;
            text-align: center;
        }

        input[type="text"] {
            background: transparent;
            border: none;
            border-bottom: 3px solid var(--gold-mid);
            color: var(--gold-light);
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            text-align: center;
            outline: none;
            width: 90%;
            max-width: 600px;
            margin-bottom: 25px;
        }

        .overall-progress-label {
            font-family: 'Playfair Display', serif;
            color: var(--gold-mid);
            font-size: 1.4rem;
            font-weight: 900;
            margin-bottom: 12px;
            display: block;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .progress-container {
            background: #222;
            border-radius: 50px;
            height: 35px;
            width: 100%;
            overflow: hidden;
            border: 2px solid var(--gold-dark);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, var(--gold-dark), var(--gold-mid), var(--gold-light), var(--gold-mid));
            background-size: 200% 100%;
            height: 100%;
            width: 0%;
            transition: width 0.8s ease;
            animation: shimmer 3s infinite linear;
        }

        @keyframes shimmer { 0% { background-position: 100% 0; } 100% { background-position: -100% 0; } }

        .ballot-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
            gap: 25px;
        }

        .category-card {
            background: var(--card-bg);
            border: 1px solid #333;
            border-top: 5px solid var(--gold-mid);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        .category-header { background: linear-gradient(to bottom, #2a2a2a, #121212); padding: 15px; border-bottom: 1px solid #333; }
        .category-card h2 { color: var(--gold-mid); font-family: 'Playfair Display', serif; font-size: 1.2rem; margin: 0; text-align: center; text-transform: uppercase; }

        .nominee-row { display: flex; align-items: center; padding: 10px 10px; border-bottom: 1px solid #222; gap: 5px; transition: background 0.2s; }
        .nominee-row.seen { background-color: rgba(212, 175, 55, 0.08); }
        .nominee-row.seen .nominee-info { color: var(--gold-light); font-weight: bold; }

        .nominee-info { flex-grow: 1; font-size: 0.85rem; color: #ccc; line-height: 1.2; padding-right: 5px; }

        .action-col { display: flex; flex-direction: column; align-items: center; min-width: 35px; }
        .action-label { font-size: 0.55rem; color: var(--gold-dark); margin-bottom: 3px; font-weight: 900; text-align: center; }

        input[type="checkbox"], input[type="radio"] { appearance: none; width: 20px; height: 20px; border: 2px solid #444; cursor: pointer; position: relative; background: #000; margin: 0; }
        input[type="checkbox"] { border-radius: 3px; }
        input[type="radio"] { border-radius: 50%; }

        input[type="checkbox"]:checked { background: var(--gold-mid); border-color: var(--gold-light); box-shadow: 0 0 8px var(--gold-mid); }
        input[type="checkbox"]:checked::after { content: '✓'; position: absolute; color: #000; font-weight: 900; left: 3px; top: -2px; font-size: 14px; }

        .radio-will:checked { background: var(--will-color); border-color: #fff; box-shadow: 0 0 8px var(--will-color); }
        .radio-should:checked { background: var(--should-color); border-color: #fff; box-shadow: 0 0 8px var(--should-color); }

        .cat-footer { display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #0a0a0a; border-top: 1px solid #222; }
        .cat-stats { font-size: 0.75rem; color: #777; }
        
        .reset-btn {
            background: transparent;
            border: 1px solid #444;
            color: #777;
            font-size: 0.65rem;
            padding: 4px 8px;
            cursor: pointer;
            text-transform: uppercase;
            border-radius: 3px;
        }
        .reset-btn:hover { color: #fff; border-color: #777; }

        @media (max-width: 600px) { 
            .ballot-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div id="infoModal">
        <div class="modal-content">
            <h2>Welcome to the Race</h2>
            <p>Your progress is saved <strong>automatically</strong> to this browser.</p>
            <p style="font-size: 0.9rem; color: #888;">Note: Progress is unique to this browser and device.</p>
            <button class="modal-btn" onclick="closeModal()">Enter the Race</button>
            <div style="margin-top: 15px; font-size: 0.8rem; color: #666;">
                <input type="checkbox" id="dontShow"> <label for="dontShow">Don't show this again</label>
            </div>
        </div>
    </div>

    <div class="header-container">
        <img src="https://raw.githubusercontent.com/SenatorAcadia/oscar-death-race/main/header.png" alt="Oscar Death Race 2026" class="header-img">
    </div>

    <div class="container">
        <div class="user-section">
            <input type="text" id="userName" placeholder="ENTER RACER NAME..." oninput="saveData()">
            <div>
                <span class="overall-progress-label" id="progressText">0% COMPLETE</span>
                <div class="progress-container">
                    <div id="mainProgressBar" class="progress-bar"></div>
                </div>
                <div style="margin-top:15px; color: var(--gold-light); font-weight: bold; font-family: 'Playfair Display'; letter-spacing: 1px;">
                    <span id="seenCount">0</span> MOVIES WATCHED
                </div>
            </div>
        </div>

        <div id="ballot" class="ballot-grid"></div>
        <p style="text-align: center; color: #444; margin: 40px 0; font-family: 'Playfair Display'; letter-spacing: 3px;">MARCH 15, 2026</p>
    </div>

    <script>
        const ballotData = [
            { category: "Best Picture", nominees: ["Bugonia (Focus Features)", "F1 (Apple)", "Frankenstein (Netflix)", "Hamnet (Focus Features)", "Marty Supreme (A24)", "One Battle after Another (Warner Bros.)", "The Secret Agent (Neon)", "Sentimental Value (Neon)", "Sinners (Warner Bros.)", "Train Dreams (Netflix)"] },
            { category: "Best Director", nominees: ["Chloé Zhao (Hamnet)", "Josh Safdie (Marty Supreme)", "Paul Thomas Anderson (One Battle after Another)", "Joachim Trier (Sentimental Value)", "Ryan Coogler (Sinners)"] },
            { category: "Best Adapted Screenplay", nominees: ["Bugonia", "Frankenstein", "Hamnet", "One Battle after Another", "Train Dreams"] },
            { category: "Best Original Screenplay", nominees: ["Blue Moon", "It Was Just an Accident", "Marty Supreme", "Sentimental Value", "Sinners"] },
            { category: "Best Actor", nominees: ["Timothée Chalamet (Marty Supreme)", "Leonardo DiCaprio (One Battle after Another)", "Ethan Hawke (Blue Moon)", "Michael B. Jordan (Sinners)", "Wagner Moura (The Secret Agent)"] },
            { category: "Best Supporting Actor", nominees: ["Benicio Del Toro (One Battle after Another)", "Jacob Elordi (Frankenstein)", "Delroy Lindo (Sinners)", "Sean Penn (One Battle after Another)", "Stellan Skarsgård (Sentimental Value)"] },
            { category: "Best Actress", nominees: ["Jessie Buckley (Hamnet)", "Rose Byrne (If I Had Legs I'd Kick You)", "Kate Hudson (Song Sung Blue)", "Renate Reinsve (Sentimental Value)", "Emma Stone (Bugonia)"] },
            { category: "Best Supporting Actress", nominees: ["Elle Fanning (Sentimental Value)", "Inga Ibsdotter Lilleaas (Sentimental Value)", "Amy Madigan (Weapons)", "Wunmi Mosaku (Sinners)", "Teyana Taylor (One Battle after Another)"] },
            { category: "Best Animated Feature", nominees: ["Arco", "Elio", "KPop Demon Hunters", "Little Amélie or the Character of Rain", "Zootopia 2"] },
            { category: "Best Casting", nominees: ["Hamnet (Nina Gold)", "Marty Supreme (Jennifer Venditti)", "One Battle after Another (Cassandra Kulukundis)", "The Secret Agent (Gabriel Domingues)", "Sinners (Francine Maisler)"] },
            { category: "Best Cinematography", nominees: ["Frankenstein (Dan Laustsen)", "Marty Supreme (Darius Khondji)", "One Battle after Another (Michael Bauman)", "Sinners (Autumn Durald Arkapaw)", "Train Dreams (Adolpho Veloso)"] },
            { category: "Best Costume Design", nominees: ["Avatar: Fire and Ash (Deborah L. Scott)", "Frankenstein (Kate Hawley)", "Hamnet (Malgosia Turzanska)", "Marty Supreme (Miyako Bellizzi)", "Sinners (Ruth E. Carter)"] },
            { category: "Best Documentary Feature", nominees: ["The Alabama Solution", "Come See Me in the Good Light", "Cutting through Rocks", "Mr. Nobody against Putin", "The Perfect Neighbor"] },
            { category: "Best Documentary Short", nominees: ["All the Empty Rooms", "Armed Only with a Camera", "Children No More", "The Devil Is Busy", "Perfectly a Strangeness"] },
            { category: "Best Film Editing", nominees: ["F1 (Stephen Mirrione)", "Marty Supreme (Ronald Bronstein)", "One Battle after Another (Andy Jurgensen)", "Sentimental Value (Olivier Bugge Coutté)", "Sinners (Michael P. Shawver)"] },
            { category: "Best International Feature Film", nominees: ["The Secret Agent (Brazil)", "It Was Just an Accident (France)", "Sentimental Value (Norway)", "Sirat (Spain)", "The Voice of Hind Rajab (Tunisia)"] },
            { category: "Best Makeup & Hairstyling", nominees: ["Frankenstein", "Kokuho", "Sinners", "The Smashing Machine", "The Ugly Stepsister"] },
            { category: "Best Original Score", nominees: ["Bugonia (Jerskin Fendrix)", "Frankenstein (Alexandre Desplat)", "Hamnet (Max Richter)", "One Battle after Another (Jonny Greenwood)", "Sinners (Ludwig Goransson)"] },
            { category: "Best Original Song", nominees: ["Dear Me (Diane Warren: Relentless)", "Golden (KPop Demon Hunters)", "I Lied To You (Sinners)", "Sweet Dreams Of Joy (Viva Verdi!)", "Train Dreams (Train Dreams)"] },
            { category: "Best Production Design", nominees: ["Frankenstein", "Hamnet", "Marty Supreme", "One Battle after Another", "Sinners"] },
            { category: "Best Short, Animated", nominees: ["Butterfly", "Forevergreen", "The Girl Who Cried Pearls", "Retirement Plan", "The Three Sisters"] },
            { category: "Best Short, Live Action", nominees: ["Butcher's Stain", "A Friend of Dorothy", "Jane Austen's Period Drama", "The Singers", "Two People Exchanging Saliva"] },
            { category: "Best Sound", nominees: ["F1", "Frankenstein", "One Battle after Another", "Sinners", "Sirat"] },
            { category: "Best Visual Effects", nominees: ["Avatar: Fire and Ash", "F1", "Jurassic World Rebirth", "The Lost Bus", "Sinners"] }
        ];

        // MASTER MOVIE LIST (To improve matching accuracy)
        const MASTER_MOVIES = [
            "Sinners", "Frankenstein", "Hamnet", "Bugonia", "Marty Supreme", 
            "One Battle after Another", "F1", "The Secret Agent", "Sentimental Value", 
            "Train Dreams", "Blue Moon", "It Was Just an Accident", "Sirat", 
            "Relentless", "Song Sung Blue", "Avatar: Fire and Ash", "Jurassic World Rebirth",
            "The Lost Bus", "The Smashing Machine", "Kokuho", "The Ugly Stepsister",
            "Arco", "Elio", "KPop Demon Hunters", "Zootopia 2"
        ];

        let userData = JSON.parse(localStorage.getItem('oscarDeathRace2026_final')) || { 
            name: "", seen: [], votesWill: {}, votesShould: {} 
        };

        // NEW ROBUST TITLE PARSER
        function getMovieTitle(nominee) {
            // Priority 1: Check if any part of the string matches a master movie title
            for (let movie of MASTER_MOVIES) {
                if (nominee.includes(movie)) return movie;
            }

            // Priority 2: Traditional parsing for items not in the master list
            let title = nominee;
            if (nominee.includes('(')) {
                // If there's a parenthesis, try both sides
                const parts = nominee.split(/[()]/).filter(p => p.trim().length > 0);
                // Usually the movie is the one with multiple words or the one that isn't a known studio name
                title = parts.length > 1 ? parts[0].trim() : parts[0].trim();
            }
            return title.trim();
        }

        function init() {
            if (localStorage.getItem('hideOscarModal') !== 'true') {
                document.getElementById('infoModal').style.display = 'block';
            }
            document.getElementById('userName').value = userData.name;
            renderBallot();
            updateStats();
        }

        function closeModal() {
            if (document.getElementById('dontShow').checked) {
                localStorage.setItem('hideOscarModal', 'true');
            }
            document.getElementById('infoModal').style.display = 'none';
        }

        function renderBallot() {
            const ballotEl = document.getElementById('ballot');
            ballotEl.innerHTML = '';
            ballotData.forEach((cat, catIdx) => {
                const card = document.createElement('div');
                card.className = 'category-card';
                let seenInCat = 0;
                
                let nomineesHtml = cat.nominees.map(nom => {
                    const movieTitle = getMovieTitle(nom);
                    const isSeen = userData.seen.includes(movieTitle);
                    if(isSeen) seenInCat++;
                    
                    const isWill = userData.votesWill[cat.category] === nom;
                    const isShould = userData.votesShould[cat.category] === nom;

                    return `
                        <div class="nominee-row ${isSeen ? 'seen' : ''}">
                            <div class="action-col">
                                <span class="action-label">SEEN</span>
                                <input type="checkbox" ${isSeen ? 'checked' : ''} onchange="toggleSeen('${movieTitle.replace(/'/g, "\\'")}')">
                            </div>
                            <div class="nominee-info">${nom}</div>
                            <div class="action-col">
                                <span class="action-label">WILL</span>
                                <input type="radio" class="radio-will" name="will-${catIdx}" ${isWill ? 'checked' : ''} onchange="castVote('${cat.category}', '${nom.replace(/'/g, "\\'")}', 'will')">
                            </div>
                            <div class="action-col">
                                <span class="action-label">SHOULD</span>
                                <input type="radio" class="radio-should" name="should-${catIdx}" ${isShould ? 'checked' : ''} onchange="castVote('${cat.category}', '${nom.replace(/'/g, "\\'")}', 'should')">
                            </div>
                        </div>`;
                }).join('');

                card.innerHTML = `
                    <div class="category-header"><h2>${cat.category}</h2></div>
                    <div class="nominee-list">${nomineesHtml}</div>
                    <div class="cat-footer">
                        <div class="cat-stats">${seenInCat} / ${cat.nominees.length} SEEN</div>
                        <button class="reset-btn" onclick="resetCategory('${cat.category}')">Reset</button>
                    </div>`;
                ballotEl.appendChild(card);
            });
        }

        function toggleSeen(movieTitle) {
            const index = userData.seen.indexOf(movieTitle);
            if (index > -1) { userData.seen.splice(index, 1); } 
            else { userData.seen.push(movieTitle); }
            saveData();
            renderBallot();
            updateStats();
        }

        function castVote(category, nominee, type) {
            if(type === 'will') userData.votesWill[category] = nominee;
            else userData.votesShould[category] = nominee;
            saveData();
        }

        function resetCategory(category) {
            delete userData.votesWill[category];
            delete userData.votesShould[category];
            saveData();
            renderBallot();
        }

        function saveData() {
            userData.name = document.getElementById('userName').value;
            localStorage.setItem('oscarDeathRace2026_final', JSON.stringify(userData));
        }

        function updateStats() {
            // Calculate strictly UNIQUE movie titles across all nominees
            const uniqueMovieTitles = new Set();
            ballotData.forEach(cat => {
                cat.nominees.forEach(nom => {
                    uniqueMovieTitles.add(getMovieTitle(nom));
                });
            });

            const totalUniqueCount = uniqueMovieTitles.size;
            const seenCount = userData.seen.length;
            const percentage = Math.round((seenCount / totalUniqueCount) * 100) || 0;

            document.getElementById('mainProgressBar').style.width = percentage + '%';
            document.getElementById('progressText').innerText = `${percentage}% COMPLETE`;
            document.getElementById('seenCount').innerText = seenCount;
            // Add a little subtitle with the true total for clarity
            document.getElementById('seenCount').parentNode.innerHTML = `<span id="seenCount">${seenCount}</span> / ${totalUniqueCount} UNIQUE MOVIES WATCHED`;
        }

        init();
    </script>
</body>
</html>
